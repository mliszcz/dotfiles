---
## Install and configure Atom.
#

- name: download atom
  get_url:
    url: "https://atom.io/download/\
          {{ (ansible_distribution in ['Debian', 'Ubuntu'])
            | ternary('deb', 'rpm') }}"
    dest: /tmp
    force: yes
  register: atom_install
  when: ansible_distribution in ['Debian', 'Ubuntu', 'CentOS', 'Fedora']

- name: install atom (ubuntu)
  apt:
    deb: '{{atom_install.dest}}'
    state: present
  become: yes
  become_method: sudo
  when: ansible_distribution in ['Debian', 'Ubuntu']

- name: install atom (fedora)
  dnf:
    name: '{{atom_install.dest}}'
    state: present
  become: yes
  become_method: sudo
  when: ansible_distribution in ['CentOS', 'Fedora']

- name: install atom packages
  command: 'apm install {{item}}'
  with_items: '{{atom_packages}}'

- name: copy configuration file
  copy:
    src: config.cson
    dest: ~/.atom/config.cson
    force: yes

- name: copy styles file
  copy:
    src: styles.less
    dest: ~/.atom/styles.less
    force: yes
